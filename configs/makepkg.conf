# /etc/makepkg.conf
# Optimized for i7 (AVX2)

# CPU Architecture
# ----------------
# -march=native: Tune for the host CPU (AVX2, FMA3, etc.)
# -O3: Aggressive optimization
# -pipe: Faster compilation
# -fno-plt: Reduced pointer indirection
# -fopenmp: Parallel processing support
CFLAGS="-march=native -O3 -pipe -fno-plt -fopenmp"
CXXFLAGS="${CFLAGS}"

# Linker
# ------
# -flto=auto: Link Time Optimization
LDFLAGS="-Wl,-O1,--sort-common,--as-needed,-z,relro,-z,now,-flto=auto"

# Rust (if needed)
RUSTFLAGS="-C opt-level=3 -C target-cpu=native"

# Parallel Compilation
# --------------------
# Use all cores
MAKEFLAGS="-j$(nproc)"

# Compression
# -----------
# Fast compression for building packages quickly
COMPRESSZST=(zstd -c -T0 --ultra -20 -)
COMPRESSXZ=(xz -c -z - --threads=0)
